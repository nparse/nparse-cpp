// A functor that parses IP addresses.
IP :=
	('[0-9]{1-3}' { stop(++n > 4 | $i > 255); }) % .?;

// A functor that parses phone numbers.
PHONE :=
	( '+'? '[0-9]{1-3}' )? ( '(' ^\d{3} :a ')' || ^\d{3} :a ) { code ?= a; } ^\d{3} -? ( ^\d{4} |? ^\d{2} -? ^\d{2} );

G := 	<IP {n: 0} n == 4>
	||	<PHONE {code: 415}>;

// Main invocation point.
S := $G ^$;
